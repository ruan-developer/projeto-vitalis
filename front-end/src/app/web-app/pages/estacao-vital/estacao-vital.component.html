<section>
  <div class="planta-container">
    <h1>Estação Vital</h1>
    <img class="planta-imagem" src="assets/imgs/estacao-vital/Novo Projeto.png" alt="Planta" />
    <div class="planta-sombra"></div>

    <div class="info-container">
      <div class="nome-planta">
        <p *ngIf="!editandoNome" (click)="habilitarEdicaoNome()">{{ nomePlanta }}</p>
        <input
          #inputNomePlanta
          *ngIf="editandoNome"
          type="text"
          [(ngModel)]="nomePlanta"
          (blur)="desabilitarEdicaoNome()"
          (keyup.enter)="desabilitarEdicaoNome()"
        />
        <button (click)="habilitarEdicaoNome()" aria-label="Editar nome da planta">
          <i class="fa-solid fa-pen"></i>
        </button>
      </div>

      <p class="nivel-atual">Nível {{ nivel }}</p>

      <div class="barra-progresso-container">
        <p class="xp-info">{{ xpAnimado }}/{{ xpMax }} XP</p>
        <div class="barra-progresso-atual" [style.width.%]="(xpAnimado / xpMax) * 100"></div>
      </div>

      <a class="registro-emocional" routerLink="/app/estacao-vital/registro-emocional">
        <button class="regar-btn">
          <i class="fa-solid fa-seedling"></i>
          <span>Regar planta</span>
        </button>
      </a>
    </div>
  </div>

  <div class="menu-direito">
    <div class="card">
      <h1><i class="icon-card fa-solid fa-bullseye"></i> Missões Diárias</h1>
      <ng-container
        *ngTemplateOutlet="missaoTemplate; context: { missoes: missoesDiarias }"
      ></ng-container>
    </div>

    <div class="card">
      <h1><i class="icon-card fa-solid fa-calendar-week"></i> Missões Semanais</h1>
      <ng-container
        *ngTemplateOutlet="missaoTemplate; context: { missoes: missoesSemanais }"
      ></ng-container>
    </div>

    <div class="card card-conquistas">
      <h1><i class="icon-card fa-solid fa-trophy"></i> Última Conquista</h1>
      <div class="intra-container">
        <div class="text-icon">
          <i class="icon-card-no-background fa-solid fa-star"></i>
          <div class="text">
            <p>{{ ultimaConquista.descricao }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<ng-template #missaoTemplate let-missoes="missoes">
  <div
    *ngFor="let missao of missoes"
    class="intra-container"
    [ngClass]="{ 'completa': missao.concluida }"
  >
    <div class="text-icon">
      <i class="icon-card-no-background fa-solid fa-hourglass"></i>
      <div class="text">
        <p>{{ missao.descricao }}</p>
      </div>
    </div>
    <p class="xp-missao">+{{ missao.xp }} XP</p>
    <button
      class="completar-btn"
      (click)="completarMissao(missao)"
      [disabled]="missao.concluida"
      aria-label="Completar missão"
    >
      <i class="fa-regular fa-circle-check"></i>
    </button>
  </div>
</ng-template>