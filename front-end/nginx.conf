# Configuração do servidor Nginx para uma aplicação Angular

# Define o número de processos de trabalho. 'auto' é o recomendado.
worker_processes auto;

events {
    # Define o número máximo de conexões simultâneas por processo.
    worker_connections 1024;
}

http {
    # Inclui tipos de arquivos (MIME types) para que o navegador entenda o que está recebendo.
    include /etc/nginx/mime.types;
    # Define o tipo padrão se nenhum outro for correspondido.
    default_type application/octet-stream;

    # Bloco do servidor principal que escuta na porta 80.
    server {
        # O Nginx vai escutar na porta 80, que é a porta que o Railway expõe.
        listen 80;
        # Define a raiz de onde os arquivos do site serão servidos.
        root /usr/share/nginx/html;
        # Define o arquivo padrão a ser procurado quando uma pasta é acessada.
        index index.html;

        # Bloco de localização para a rota raiz e todas as outras.
        location / {
            # Esta é a linha mais importante para SPAs como o Angular.
            # 1. Tenta encontrar o arquivo exato solicitado ($uri).
            # 2. Se não encontrar, tenta ver se é um diretório ($uri/).
            # 3. Se não encontrar nada, ele serve o /index.html,
            #    permitindo que o roteamento do Angular assuma o controle.
            try_files $uri $uri/ /index.html;
        }
    }
}